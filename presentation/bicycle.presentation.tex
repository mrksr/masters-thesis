\input{preamble.tex}
\input{figures/tikz_common.tex}
\input{figures/tikz_colors.tex}
\input{figures/tikz_jumping.tex}
\input{../thesis/preamble/abbreviations.tex}

\title{Incorporating Uncertainty into Reinforcement Learning through Gaussian Processes}
\author{Markus Kaiser}
\subtitle{Master's Thesis}
\author{\href{mailto:markus.kaiser@in.tum.de}{Markus Kaiser}}
\titlegraphic{\parbox{.95\textwidth}{%
    \raisebox{-.5\height}{\includegraphics[height=1.5cm,width=.33\linewidth,keepaspectratio]{tum}}%
    \hfill%
    \raisebox{-.5\height}{\includegraphics[height=1.5cm,width=.33\linewidth,keepaspectratio]{kth}}%
    \hfill%
    \raisebox{-.5\height}{\includegraphics[height=1.5cm,width=.33\linewidth,keepaspectratio]{siemens}}%
}}
\date{4. July 2016}

\begin{document}

\begin{frame}[plain]
    \titlepage
\end{frame}

\begin{frame}
    \frametitle{Outline}

    \tableofcontents
\end{frame}

\section{The Bicycle Benchmark}
\begin{frame}[label=bicycle_drive]
    \frametitle{Bicycle Benchmark -- Driving}

    \begin{columns}
        \begin{column}[c]{0.5\textwidth}
            \centering
            \includestandalone{figures/bicycle_from_above}
        \end{column}
        \begin{column}[c]{0.5\textwidth}
            \centering
            \vspace{1cm}
            \uncover<7-> {
                \includestandalonewithpath{figures/bicycle_drive_goal}
            }
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}[label=bicycle_balance]
    \frametitle{Bicycle Benchmark -- Balancing}

    \vfill
    \begin{columns}
        \begin{column}{0.45\textwidth}
            \centering
            \includestandalone{figures/bicycle_from_behind}
        \end{column}
        \begin{column}{0.55\textwidth}
            \centering
            \uncover<4-> {
                \includestandalonewithpath{figures/bicycle_drive_balance}
            }
        \end{column}
    \end{columns}
\end{frame}

\section{Gaussian Processes}
\begin{frame}[label=gp_non_parametric_models]
    \frametitle{Non-Parametric Models}

    \begin{block}{Yoyoyo}
        Blarghl
    \end{block}
    \vfill
    \centering
    \includestandalonewithpath{figures/non_parametric_models}
\end{frame}

\begin{frame}[label=gp_definition]
    \frametitle{Gaussian Processes}

    \begin{definition}[Gaussian Process]
        A \structure{Gaussian Process} is a collection of random variables, any finite subset of which has a joint Gaussian distribution.
    \end{definition}
\end{frame}

\begin{frame}[label=gp_kernels]
    \frametitle{Kernels and Hyperparameters}

    \begin{block}{Yoyoyo}
        Blarghl
    \end{block}
    \vfill
    \centering
    \includestandalonewithpath{figures/gp_posterior}
\end{frame}

\begin{frame}[label=gp_sparse]
    \frametitle{Sparse Gaussian Processes}

    \centering
    \includestandalonewithpath{figures/spgp}
\end{frame}

\section{Uncertainties in Reinforcement Learning}
\begin{frame}[label=solution_architecture]
    \frametitle{Solution Architecture}

    \centering
    \includestandalone{figures/agent_environment}
\end{frame}

\begin{frame}[label=solution_psop]
    \frametitle{PSO-P}

    \begin{align}
        \label{eq:action_value_function}
        \AVlu_{\mat{s_0}} \colon \left\{
            \begin{aligned}
                \Ah^T &\to \R \\
                \left( \mat{a_0}, \dots, \mat{a_{T-1}} \right) &\mapsto \Moment*{\E}{\sum_{t=1}^T \gamma^t \Rwd(\mat{s_t}) \given f, \mat{s_0}, \mat{a_0}, \dots, \mat{a_{T-1}}}
            \end{aligned}
            \right.
        \end{align}

    \begin{definition}[PSO-P]
        \label{def:psop}
        The \emph{Particle Swarm Optimization-Policy (PSO-P)} chooses actions via direct optimization of the action value function $\AVlu$ and is defined as
        \begin{align}
            \pi_{\text{PSO-P}} &: \left\{
            \begin{aligned}
                \Es &\to \Ah\\
                \mat{s} &\mapsto \mat{a^\ast}_0 \text{, where } \mat{a^\ast} \in \argmax_{\mat{a} \in \Ah^T} \AVlu_{\mat{s}}(\mat{a}).
            \end{aligned}
            \right.
        \end{align}
    \end{definition}
\end{frame}

\begin{frame}[label=solution_reward]
    \frametitle{Reward Function}

    \begin{definition}[Bicycle Reward Function]
        Given the set $\Es^+$ of possible states of the bicycle benchmark and the sets $\Goal$ and $\Fallen$ of all terminal states where the bicycle has reached the goal or fallen respectively, the \emph{bicycle reward function} is defined as
        \begin{align}
            \RwdBicycle \colon \left\{
                \begin{aligned}
                    \Es^+ &\to \R \\
                    \mat{s} &\mapsto \begin{cases}
                    2 & \text{if $\mat{s} \in \Goal$} \\
                    0 & \text{if $\mat{s} \in \Fallen$} \\
                    \sqrt{2\pi\sigma_{\text{angle}}^2}\Gaussian{\Delta^\psi_{\mat{s}} \given 0, \sigma_{\text{angle}}^2} & \text{otherwise}
                \end{cases}
            \end{aligned}
            \right.
        \end{align}
    where $\Delta^\psi_{\mat{s}} = \abs{\psi_{\mat{s}} - \varphi_{\mat{s}}} \in (-\pi, \pi]$ denotes the difference between the bicycle's heading and the goal given a state $\mat{s}$ and $\sigma_{\text{angle}}^2$ is a positive real constant.
    The Gaussian density function $\Norm$ is normalized to a maximum value of 1.
    \end{definition}
\end{frame}

\begin{frame}[label=solution_map]
    \frametitle{MAP without Uncertainties}

    \centering
    \includestandalonewithpath{figures/map}
\end{frame}

\begin{frame}[label=solution_map_predictions]
    \frametitle{MAP Predictions}

    \centering
    \includestandalonewithpath{figures/map_predictions}
\end{frame}

\begin{frame}[label=solution_os]
    \frametitle{One-Step Uncertainties}

    \centering
    \includestandalonewithpath{figures/one_step}
\end{frame}

\begin{frame}[label=solution_os_predictions]
    \frametitle{One-Step Predictions}

    \centering
    \includestandalonewithpath{figures/one_step_uncertainties}
\end{frame}

\begin{frame}[label=solution_ms]
    \frametitle{Multi-Step Uncertainties}

    \centering
    \includestandalonewithpath{figures/linearization}
\end{frame}

\begin{frame}[label=solution_ms_predictions]
    \frametitle{Multi-Step Predictions}

    \centering
    \includestandalonewithpath{figures/linearization_predictions}
\end{frame}

\section{Results}
\begin{frame}[label=results_qualitative]
    \frametitle{Qualitative}

    \centering
    \includestandalonewithpath{figures/xy_trajectories}
\end{frame}

\begin{frame}[label=results_quantitative]
    \frametitle{Quantitative Results}

    \centering
    \vfill
    \begin{columns}
        \begin{column}[c]{0.5\textwidth}
            \centering
            \uncover<2> {
                \includestandalonewithpath{figures/goal_percentage}
            }
        \end{column}
        \begin{column}[c]{0.5\textwidth}
            \centering
            \begin{tabularx}{\textwidth}{X>{\centering\hsize=.4\hsize}X>{\centering\hsize=.4\hsize}X>{\centering\hsize=.4\hsize\arraybackslash}X}
                \toprule
                Metric & MAP & OS & MS \\
                \midrule
                Trajectories & 9660 & 9660 & 9660 \\
                Success Rate & \SI[mode=text]{53.4}{\percent} & \SI[mode=text]{63.8}{\percent} & \textbf{\SI[mode=text,detect-weight]{75.8}{\percent}} \\
                \addlinespace
                Time to Goal \\
                Mean & \textbf{59.9} & 62.0 & 66.5 \\
                Median & \textbf{60} & \textbf{60} & 63 \\
                \bottomrule
            \end{tabularx}
        \end{column}
    \end{columns}
\end{frame}

\end{document}
